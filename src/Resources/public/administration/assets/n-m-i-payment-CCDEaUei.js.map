{"version":3,"file":"n-m-i-payment-CCDEaUei.js","sources":["../../../app/administration/src/component/nmi-api-test/nmi-api.html.twig","../../../app/administration/src/component/nmi-api-test/index.js","../../../app/administration/src/service/nmi-api-test.service.js","../../../app/administration/src/main.js"],"sourcesContent":["<div>\n    <sw-button-process\n            :is-loading=\"isLoading\"\n            :process-success=\"isSaveSuccessful\"\n            @process-finish=\"saveFinish\"\n            @click=\"check\"\n    >\n        {{ $tc('NMI.apiTest.connection.test-api-connection') }}\n    </sw-button-process>\n</div>","import template from './nmi-api.html.twig';\n\nconst { Component, Mixin } = Shopware;\n\nComponent.register('nmi-api-test', {\n    template,\n\n    props: ['label'],\n    inject: ['NmiApiTestService'],\n\n    mixins: [Mixin.getByName('notification')],\n\n    data() {\n        return {\n            isLoading: false,\n            isSaveSuccessful: false,\n        };\n    },\n\n    computed: {\n        pluginConfig() {\n            let $parent = this.$parent;\n\n            while ($parent.actualConfigData === undefined) {\n                $parent = $parent.$parent;\n            }\n\n            return $parent.actualConfigData.null;\n        },\n    },\n\n    methods: {\n        saveFinish() {\n            this.isSaveSuccessful = false;\n        },\n\n        getCurrentSalesChannelId() {\n            let $parent = this.$parent;\n\n            while ($parent.currentSalesChannelId === undefined) {\n                $parent = $parent.$parent;\n            }\n\n            return $parent.currentSalesChannelId;\n        },\n\n        check() {\n            this.isLoading = true;\n\n            const payload = {\n                ...this.pluginConfig,\n                salesChannelId: this.getCurrentSalesChannelId()\n            };\n\n            this.NmiApiTestService\n                .check(payload)\n\n                .then((response) => {\n                    if (response.success) {\n                        this.isSaveSuccessful = true;\n                        let message = this.$tc('NMI.apiTest.success.message');\n                        if (response.webhookUrl) {\n                            message += `\\n\\nWebhook URL: ${response.webhookUrl}\\n\\nPlease register this URL in NMI merchant portal (Settings > Webhooks) and subscribe to all events.`;\n                        }\n                        this.createNotificationSuccess({\n                            title: this.$tc('NMI.apiTest.success.title'),\n                            message: message,\n                        });\n                    } else {\n                        this.createNotificationError({\n                            title: this.$tc('NMI.apiTest.error.title'),\n                            message: this.$tc('NMI.apiTest.error.message'),\n                        });\n                    }\n                })\n                .catch((error) => {\n                    this.createNotificationError({\n                        title: 'NMI API Test',\n                        message: error.response?.data?.errors?.[0]?.detail || error.message || 'Connection failed!',\n                    });\n                })\n                .finally(() => {\n                    this.isLoading = false;\n                });\n        },\n    },\n});\n","const ApiService = Shopware.Classes.ApiService;\n\nexport default class NmiApiTestService extends ApiService {\n\n    constructor(httpClient, loginService, apiEndpoint = 'nmi-test-connection') {\n        super(httpClient, loginService, apiEndpoint);\n    }\n    check(values) {\n        const headers = this.getBasicHeaders();\n\n        return this.httpClient\n            .post(`_action/${this.getApiBasePath()}/test-connection`, values, {\n                headers,\n            })\n            .then((response) => {\n                return ApiService.handleResponse(response);\n            });\n    }\n}","import './component/nmi-api-test';\n\nimport NmiApiTestService from './service/nmi-api-test.service';\n\nShopware.Service().register('NmiApiTestService', () => {\n    return new NmiApiTestService(\n        Shopware.Application.getContainer('init').httpClient,\n        Shopware.Service('loginService')\n    );\n});"],"names":["template","Component","Mixin","$parent","payload","response","message","error","_a","_b","_c","_d","ApiService","NmiApiTestService","httpClient","loginService","apiEndpoint","values","headers"],"mappings":"AAAA,MAAAA,EAAe,yNCET,CAAE,UAAAC,EAAW,MAAAC,CAAK,EAAK,SAE7BD,EAAU,SAAS,eAAgB,CAC/B,SAAAD,EAEA,MAAO,CAAC,OAAO,EACf,OAAQ,CAAC,mBAAmB,EAE5B,OAAQ,CAACE,EAAM,UAAU,cAAc,CAAC,EAExC,MAAO,CACH,MAAO,CACH,UAAW,GACX,iBAAkB,EAC9B,CACA,EAEI,SAAU,CACN,cAAe,CACX,IAAIC,EAAU,KAAK,QAEnB,KAAOA,EAAQ,mBAAqB,QAChCA,EAAUA,EAAQ,QAGtB,OAAOA,EAAQ,iBAAiB,IAC5C,CACA,EAEI,QAAS,CACL,YAAa,CACT,KAAK,iBAAmB,EACpC,EAEQ,0BAA2B,CACvB,IAAIA,EAAU,KAAK,QAEnB,KAAOA,EAAQ,wBAA0B,QACrCA,EAAUA,EAAQ,QAGtB,OAAOA,EAAQ,qBAC3B,EAEQ,OAAQ,CACJ,KAAK,UAAY,GAEjB,MAAMC,EAAU,CACZ,GAAG,KAAK,aACR,eAAgB,KAAK,yBAAwB,CAC7D,EAEY,KAAK,kBACA,MAAMA,CAAO,EAEb,KAAMC,GAAa,CAChB,GAAIA,EAAS,QAAS,CAClB,KAAK,iBAAmB,GACxB,IAAIC,EAAU,KAAK,IAAI,6BAA6B,EAChDD,EAAS,aACTC,GAAW;AAAA;AAAA,eAAoBD,EAAS,UAAU;AAAA;AAAA,qGAEtD,KAAK,0BAA0B,CAC3B,MAAO,KAAK,IAAI,2BAA2B,EAC3C,QAASC,CACrC,CAAyB,CACzB,MACwB,KAAK,wBAAwB,CACzB,MAAO,KAAK,IAAI,yBAAyB,EACzC,QAAS,KAAK,IAAI,2BAA2B,CACzE,CAAyB,CAEzB,CAAiB,EACA,MAAOC,GAAU,CD3ElC,IAAAC,EAAAC,EAAAC,EAAAC,EC4EoB,KAAK,wBAAwB,CACzB,MAAO,eACP,UAASA,GAAAD,GAAAD,GAAAD,EAAAD,EAAM,WAAN,YAAAC,EAAgB,OAAhB,YAAAC,EAAsB,SAAtB,YAAAC,EAA+B,KAA/B,YAAAC,EAAmC,SAAUJ,EAAM,SAAW,oBAC/F,CAAqB,CACrB,CAAiB,EACA,QAAQ,IAAM,CACX,KAAK,UAAY,EACrC,CAAiB,CACjB,CACA,CACA,CAAC,ECtFD,MAAMK,EAAa,SAAS,QAAQ,WAErB,MAAMC,UAA0BD,CAAW,CAEtD,YAAYE,EAAYC,EAAcC,EAAc,sBAAuB,CACvE,MAAMF,EAAYC,EAAcC,CAAW,CACnD,CACI,MAAMC,EAAQ,CACV,MAAMC,EAAU,KAAK,gBAAe,EAEpC,OAAO,KAAK,WACP,KAAK,WAAW,KAAK,eAAc,CAAE,mBAAoBD,EAAQ,CAC9D,QAAAC,CAChB,CAAa,EACA,KAAMb,GACIO,EAAW,eAAeP,CAAQ,CAC5C,CACb,CACA,CCdA,SAAS,QAAO,EAAG,SAAS,oBAAqB,IACtC,IAAIQ,EACP,SAAS,YAAY,aAAa,MAAM,EAAE,WAC1C,SAAS,QAAQ,cAAc,CACvC,CACC"}