const r=`<div> <sw-button-process :is-loading="isLoading" :process-success="isSaveSuccessful" @process-finish="saveFinish" @click="check" > {{ $tc('NMI.apiTest.connection.test-api-connection') }} </sw-button-process> </div>`,{Component:o,Mixin:l}=Shopware;o.register("nmi-api-test",{template:r,props:["label"],inject:["NmiApiTestService"],mixins:[l.getByName("notification")],data(){return{isLoading:!1,isSaveSuccessful:!1}},computed:{pluginConfig(){let e=this.$parent;for(;e.actualConfigData===void 0;)e=e.$parent;return e.actualConfigData.null}},methods:{saveFinish(){this.isSaveSuccessful=!1},getCurrentSalesChannelId(){let e=this.$parent;for(;e.currentSalesChannelId===void 0;)e=e.$parent;return e.currentSalesChannelId},check(){this.isLoading=!0;const e={...this.pluginConfig,salesChannelId:this.getCurrentSalesChannelId()};this.NmiApiTestService.check(e).then(t=>{if(t.success){this.isSaveSuccessful=!0;let s=this.$tc("NMI.apiTest.success.message");t.webhookUrl&&(s+=`

Webhook URL: ${t.webhookUrl}

Please register this URL in NMI merchant portal (Settings > Webhooks) and subscribe to all events.`),this.createNotificationSuccess({title:this.$tc("NMI.apiTest.success.title"),message:s})}else this.createNotificationError({title:this.$tc("NMI.apiTest.error.title"),message:this.$tc("NMI.apiTest.error.message")})}).catch(t=>{var s,i,n,a;this.createNotificationError({title:"NMI API Test",message:((a=(n=(i=(s=t.response)==null?void 0:s.data)==null?void 0:i.errors)==null?void 0:n[0])==null?void 0:a.detail)||t.message||"Connection failed!"})}).finally(()=>{this.isLoading=!1})}}});const c=Shopware.Classes.ApiService;class h extends c{constructor(t,s,i="nmi-test-connection"){super(t,s,i)}check(t){const s=this.getBasicHeaders();return this.httpClient.post(`_action/${this.getApiBasePath()}/test-connection`,t,{headers:s}).then(i=>c.handleResponse(i))}}Shopware.Service().register("NmiApiTestService",()=>new h(Shopware.Application.getContainer("init").httpClient,Shopware.Service("loginService")));
//# sourceMappingURL=n-m-i-payment-CCDEaUei.js.map
